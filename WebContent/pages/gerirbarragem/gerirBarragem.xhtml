<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<f:loadBundle basename="message-bundle" var="msg" />

<head>
<title>#{msg.label_titulo}</title>
</head>
<body>
<div class="centro-conteudo"><h:form>
	<label class="label_regular">#{msg.label_bem_vindo}</label>
	<br />

	<label class="label_regular">#{msg.label_minhas_barragens}</label>

	<h:panelGrid columns="4" id="painelBarragens">
		<label class="label_regular">#{msg.label_barragem}</label>
		<label class="label_regular">#{msg.label_local}</label>
		<label class="label_regular">#{msg.label_administrador}</label>
		<a4j:commandButton value="+"
			actionListener="#{gerirBarragemBean.novaBarragem}"
			oncomplete="Richfaces.showModalPanel('panel');" />

		<c:forEach items="#{gerirBarragemBean.usuario.barragens}"
			item="item" varStatus="status">
			<label class="label_regular">#{item.local}</label>
			<label class="label_regular">#{item.nome}</label>
			<label class="label_regular">#{item.administrador}</label>
			<a4j:commandButton value="-" reRender="painelBarragens"
				limitToList="true"
				actionListener="#{gerirBarragemBean.removeBarragem}"
				immediate="true">
				<f:param name="index" value="#{status.index}" />
			</a4j:commandButton>
		</c:forEach>
	</h:panelGrid>
	<br />

	<h:commandButton actionListener="#{gerirBarragemBean.salva}"
		value="Salva!" />

</h:form></div>


<rich:modalPanel id="panel" width="600" height="500">
	<f:facet name="header">
		<h:outputText value="#{msg.label_nova_barragem}" />
	</f:facet>
	<f:facet name="controls">
		<a href="javascript:Richfaces.hideModalPanel('panel');">X</a>
	</f:facet>

	<h:form>
		<h:panelGrid columns="3">
			<h:outputText styleClass="label_regular" value="#{msg.label_local}" />
			<h:outputText styleClass="label_regular" value="#{msg.label_nome}" />
			<h:outputText styleClass="label_regular"
				value="#{msg.label_administrador}" />
			<h:inputText value="#{gerirBarragemBean.barragem.local}" />
			<h:inputText value="#{gerirBarragemBean.barragem.nome}" />
			<h:inputText
				value="#{gerirBarragemBean.barragem.administrador.nome}"
				disabled="true" />
		</h:panelGrid>

		<h:panelGrid columns="2" id="painelJogadores">
			<label class="label_regular">#{msg.label_jogadores}</label>
			<a4j:commandButton value="+" reRender="painelJogadores"
				limitToList="true"
				actionListener="#{gerirBarragemBean.adicionaJogador}"
				immediate="true" />

			<c:forEach items="#{gerirBarragemBean.barragem.jogadores}"
				item="item" varStatus="status">
				<h:selectOneMenu
					value="#{gerirBarragemBean.barragem.jogadores[status.index]}"
					converter="JogadorConverter">
					<f:selectItems value="#{lookupBean.listaJogadores}" />
				</h:selectOneMenu>
				<a4j:commandButton value="-" reRender="painelJogadores"
					limitToList="true"
					actionListener="#{gerirBarragemBean.removeJogador}"
					immediate="true">
					<f:param name="index" value="#{status.index}" />
				</a4j:commandButton>
			</c:forEach>
		</h:panelGrid>
		<a4j:commandButton actionListener="#{gerirBarragemBean.salva}"
			value="#{msg.label_salvar}" reRender="painelBarragens" />
	</h:form>
</rich:modalPanel>

</body>
</html>