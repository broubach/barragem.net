<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<f:loadBundle basename="message-bundle" var="msg" />

<head>
<title>#{msg.label_titulo}</title>
</head>
<body>
<div class="centro-conteudo"><h:form>
	<h:outputText styleClass="label_regular" value="#{msg.label_bem_vindo}" />
	<br />

	<h:outputText styleClass="label_regular"
		value="#{msg.label_minhas_barragens}" />

	<h:panelGrid columns="4" id="painelBarragens">
		<h:outputText styleClass="label_regular" value="#{msg.label_barragem}" />
		<h:outputText styleClass="label_regular" value="#{msg.label_local}" />
		<h:outputText styleClass="label_regular"
			value="#{msg.label_administrador}" />
		<a4j:commandButton value="+" reRender="panel"
			actionListener="#{gerirBarragemBean.novaBarragem}"
			oncomplete="Richfaces.showModalPanel('panel');" immediate="true" />

		<c:forEach items="#{gerirBarragemBean.barragens}" var="item"
			varStatus="status">
			<a4j:commandLink reRender="panel"
				actionListener="#{gerirBarragemBean.detalhaBarragem}"
				oncomplete="Richfaces.showModalPanel('panel');" immediate="true">
				<f:param name="index" value="#{status.index}" />
				<h:outputText styleClass="label_regular" value="#{item.local}" />
			</a4j:commandLink>
			<a4j:commandLink reRender="panel"
				actionListener="#{gerirBarragemBean.detalhaBarragem}"
				oncomplete="Richfaces.showModalPanel('panel');" immediate="true">
				<f:param name="index" value="#{status.index}" />
				<h:outputText styleClass="label_regular" value="#{item.nome}" />
			</a4j:commandLink>
			<a4j:commandLink reRender="panel"
				actionListener="#{gerirBarragemBean.detalhaBarragem}"
				oncomplete="Richfaces.showModalPanel('panel');" immediate="true">
				<f:param name="index" value="#{status.index}" />
				<h:outputText styleClass="label_regular"
					value="#{item.administrador.nome}" />
			</a4j:commandLink>
			<a4j:commandButton value="-" reRender="painelBarragens"
				actionListener="#{gerirBarragemBean.removeBarragem}"
				immediate="true">
				<f:param name="index" value="#{status.index}" />
			</a4j:commandButton>
		</c:forEach>
	</h:panelGrid>
	<br />

</h:form></div>


<rich:modalPanel id="panel" width="600" height="500">
	<f:facet name="header">
		<h:outputText value="#{msg.label_nova_barragem}" />
	</f:facet>
	<f:facet name="controls">
		<a href="javascript:Richfaces.hideModalPanel('panel');">X</a>
	</f:facet>

	<h:form>
		<h:panelGrid columns="3">
			<h:outputText styleClass="label_regular" value="#{msg.label_local}" />
			<h:outputText styleClass="label_regular" value="#{msg.label_nome}" />
			<h:outputText styleClass="label_regular"
				value="#{msg.label_administrador}" />
			<h:inputText value="#{gerirBarragemBean.barragemEmFoco.local}" />
			<h:inputText value="#{gerirBarragemBean.barragemEmFoco.nome}" />
			<h:inputText
				value="#{gerirBarragemBean.barragemEmFoco.administrador.nome}"
				disabled="true" />
		</h:panelGrid>

		<h:panelGrid columns="2" id="painelJogadores">
			<h:outputText styleClass="label_regular"
				value="#{msg.label_jogadores}" />
			<a4j:commandButton value="+" reRender="painelJogadores"
				actionListener="#{gerirBarragemBean.adicionaJogador}"
				immediate="true" />

			<c:forEach items="#{gerirBarragemBean.barragemEmFoco.jogadores}"
				var="item" varStatus="status">
				<h:selectOneMenu
					value="#{gerirBarragemBean.barragemEmFoco.jogadores[status.index]}"
					converter="JogadorConverter">
					<f:selectItems value="#{lookupBean.listaJogadores}" />
				</h:selectOneMenu>
				<a4j:commandButton value="-" reRender="painelJogadores"
					actionListener="#{gerirBarragemBean.removeJogador}"
					immediate="true">
					<f:param name="index" value="#{status.index}" />
				</a4j:commandButton>
			</c:forEach>

			<a4j:commandButton
				actionListener="#{gerirBarragemBean.salvaBarragem}"
				value="#{msg.label_salvar}"
				reRender="painelBarragens,painelJogadores" />
		</h:panelGrid>
	</h:form>

</rich:modalPanel>

</body>
</html>